import{j as q,g as h,c as d,a as A,w as s,r as v,o as n,b as t,u as P,k as W,d as u,m as Z,l as ee,t as o,F as k,f as b,h as V,E as C}from"./index-Dz3Qabv_.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ae="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAIAAAD9mks1AAAACXBIWXMAAAsSAAALEgHS3X78AAABR0lEQVR4nO3RMQEAIAzAsIF/zyCw4UoIu0kz3gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPg0Bq8AARz1Xn8AAAAASUVORK5CYII=";async function se(c){if(!c)throw new Error("缺少图片文件");return await new Promise(l=>setTimeout(l,400)),{imageId:`mock_${Date.now()}`}}async function le(c){return await new Promise(l=>setTimeout(l,300)),ae()}function ae(){const c=new Date,l=r=>String(r).padStart(2,"0"),m=`${c.getFullYear()}-${l(c.getMonth()+1)}-${l(c.getDate())} ${l(c.getHours())}:${l(c.getMinutes())}`;return{meta:{reportId:`RPT-${c.getFullYear()}${l(c.getMonth()+1)}${l(c.getDate())}-${Math.floor(Math.random()*9e3+1e3)}`,generatedAt:m,model:"Mock-Auriculo-Insight v0.1（演示）",disclaimer:"本报告为演示用模拟结果，仅用于科普与自我管理参考，不能替代临床诊断。"},overview:{earColor:"耳廓色泽偏淡红，局部可见轻度潮红（与近期作息波动/情绪紧张可能相关）。",morphology:"耳廓整体形态匀称，耳甲腔区略显紧绷；对耳轮缘处纹理略粗。",moisture:"皮肤质地偏干，建议注意补水与油脂平衡；避免频繁辛辣与熬夜。",symmetry:"左右对比：右侧耳甲腔敏感点较多，提示消化与情志相关反应较突出。"},keyAreas:[{area:"耳甲腔（对应脏腑区）",finding:"轻度压痛点与颗粒感",implication:"提示脾胃运化负担偏重、饮食节律不稳或压力性进食。"},{area:"对耳轮（脊柱反射区）",finding:"局部紧绷、触感偏硬",implication:"久坐/低头较多，颈肩背肌群紧张，建议放松拉伸。"},{area:"耳屏/屏间切迹（神经-内分泌相关）",finding:"敏感度轻度升高",implication:"近期睡眠质量波动、精神紧张时易出现反应。"}],constitution:{type:"气郁夹湿（偏向）",evidence:["情绪紧张时耳屏敏感点增加","耳甲腔区反应较明显，提示脾胃运化受影响","皮肤偏干但局部潮红，符合气机郁滞与津液代谢失衡的组合表现"],tcmInterpretation:"气机郁滞则疏泄不利，久则影响脾运，湿困中焦；情志与作息为关键诱因。"},suggestions:{lifestyle:["作息：建议 23:00 前入睡，连续 7 天观察睡眠深度与晨起精神变化。","饮食：晚餐七分饱，减少夜宵、奶茶甜食与酒精；多温热熟食，少生冷。","运动：每日快走/慢跑 20-30 分钟，配合肩颈拉伸 5 分钟。"],acupressure:["按揉频次：每日 1-2 次，每次 3-5 分钟，酸胀为度，避免按压破皮。","推荐区域：耳甲腔（脾胃相关）、耳屏（安神相关）、对耳轮（颈肩相关）。","操作提示：可先热敷 30-60 秒再按揉；左右交替，痛点处停留 3 秒放松。"],riskAlerts:["若出现持续耳鸣加重、眩晕、胸闷心悸、突发听力下降等，请尽快线下就医。","孕期、皮肤破损或严重过敏者不建议自行强刺激按压。"]},nextSteps:{recommendedFollowUp:"建议 7 天后在“耳穴诊断”页复测一次，观察敏感点与色泽变化趋势。",dataToCollect:["睡眠时长与入睡时间","三餐时间与夜宵频率","情绪压力评分(1-5)"]}}}const oe={class:"diag"},ne={key:0,class:"stage"},ie={class:"upload-grid"},re={class:"upload-left"},de={class:"drop"},ue={class:"actions"},ce={class:"hint"},ve={class:"upload-right"},pe={class:"preview"},_e=["src"],me={key:1,class:"stage analyzing"},ge={class:"center"},fe={class:"progress"},we={key:2,class:"stage"},ye={class:"report-top"},ke={class:"muted"},be={class:"report-actions"},he={class:"report-grid"},Ie={class:"areas"},Ue={class:"area-title"},Re={class:"area-row"},Ce={class:"v"},Me={class:"area-row"},Le={class:"v"},Te={class:"list"},xe={class:"two-col"},De={class:"list"},Se={class:"list"},$e={class:"list"},Be={__name:"Diagnosis",setup(c){const l=h(0),m=h(null),r=h(""),g=h(0),a=h(null);let I=null,U=null;const z=Z(()=>r.value||Ae);function F(p){const e=p==null?void 0:p.raw;e&&(m.value=e,r.value&&URL.revokeObjectURL(r.value),r.value=URL.createObjectURL(e))}function N(){m.value=new File([],"placeholder.png",{type:"image/png"}),r.value&&URL.revokeObjectURL(r.value),r.value="",C.success("已使用示例图（演示）")}function X(){l.value=0,m.value=null,a.value=null,g.value=0,y(),r.value&&URL.revokeObjectURL(r.value),r.value=""}function Y(){l.value=0,a.value=null,g.value=0,y()}function y(){I&&clearTimeout(I),U&&clearInterval(U),I=null,U=null}async function G(){if(!m.value){C.warning("请先上传或使用示例图");return}y(),l.value=1,g.value=8,U=setInterval(()=>{g.value=Math.min(95,g.value+Math.floor(Math.random()*8+3))},260);try{const{imageId:p}=await se(m.value);I=setTimeout(async()=>{const e=await le(p);a.value=e,g.value=100,y(),l.value=2,C.success("分析完成（模拟）")},3e3)}catch(p){y(),l.value=0,g.value=0,C.error((p==null?void 0:p.message)||"分析失败（模拟）")}}return q(()=>{y(),r.value&&URL.revokeObjectURL(r.value)}),(p,e)=>{const M=v("el-step"),H=v("el-steps"),f=v("el-card"),T=v("el-icon"),J=v("el-upload"),R=v("el-button"),x=v("el-alert"),K=v("el-progress"),_=v("el-descriptions-item"),L=v("el-descriptions"),D=v("el-tag"),Q=v("el-divider");return n(),d("div",oe,[A(f,{shadow:"hover",class:"head"},{default:s(()=>[e[0]||(e[0]=t("div",{class:"page-title"},"耳穴诊断（演示）",-1)),e[1]||(e[1]=t("p",{class:"page-subtitle"}," 使用三步流程模拟 AI 耳廓图像分析：上传 → 分析 → 报告。后续可替换为真实 AI 图像服务与后端存储。 ",-1)),A(H,{active:l.value,"align-center":""},{default:s(()=>[A(M,{title:"上传图片",description:"上传耳部照片或使用示例图"}),A(M,{title:"AI分析中",description:"解析颜色、形态与敏感区域"}),A(M,{title:"查看报告",description:"体质辨识与健康建议"})]),_:1},8,["active"])]),_:1}),A(f,{shadow:"hover",class:"body"},{default:s(()=>{var S,$,B,O,E,j;return[l.value===0?(n(),d("section",ne,[t("div",ie,[t("div",re,[t("div",de,[A(J,{drag:"",action:"#","auto-upload":!1,"show-file-list":!1,"on-change":F,accept:"image/*"},{default:s(()=>[A(T,{class:"up-icon"},{default:s(()=>[A(P(W))]),_:1}),e[2]||(e[2]=t("div",{class:"el-upload__text"},[t("b",null,"点击上传耳部照片"),u(" 或拖拽到此处 ")],-1)),e[3]||(e[3]=t("div",{class:"el-upload__tip"},"支持 JPG/PNG；演示版不做真实上传",-1))]),_:1})]),t("div",ue,[A(R,{type:"primary",disabled:!m.value,onClick:G},{default:s(()=>[...e[4]||(e[4]=[u(" 开始AI分析 ",-1)])]),_:1},8,["disabled"]),A(R,{onClick:N},{default:s(()=>[...e[5]||(e[5]=[u("使用示例图",-1)])]),_:1}),A(R,{text:"",onClick:X},{default:s(()=>[...e[6]||(e[6]=[u("清空",-1)])]),_:1})]),t("div",ce,[A(x,{title:"提示",type:"warning",closable:!1,description:"此为演示原型：上传与分析均为模拟流程，报告为 mock 数据。","show-icon":""})])]),t("div",ve,[e[7]||(e[7]=t("div",{class:"preview-title"},"预览",-1)),t("div",pe,[t("img",{src:z.value,alt:"耳部预览"},null,8,_e)]),e[8]||(e[8]=t("div",{class:"muted preview-foot"}," 建议：自然光、耳廓完整入镜、避免滤镜与过曝。 ",-1))])])])):l.value===1?(n(),d("section",me,[t("div",ge,[A(T,{class:"big spin"},{default:s(()=>[A(P(ee))]),_:1}),e[9]||(e[9]=t("div",{class:"title"},"AI 正在分析…",-1)),e[10]||(e[10]=t("div",{class:"desc"},"AI正在分析耳廓颜色、形态、穴位反应...",-1)),t("div",fe,[A(K,{percentage:g.value,"stroke-width":14},null,8,["percentage"])]),e[11]||(e[11]=t("div",{class:"muted small"}," 预计耗时约 3 秒（模拟）。请稍候，不要刷新页面。 ",-1))])])):(n(),d("section",we,[t("div",ye,[t("div",null,[e[12]||(e[12]=t("div",{class:"report-title"},"诊断报告",-1)),t("div",ke," 报告编号："+o(($=(S=a.value)==null?void 0:S.meta)==null?void 0:$.reportId)+" ｜生成时间："+o((O=(B=a.value)==null?void 0:B.meta)==null?void 0:O.generatedAt),1)]),t("div",be,[A(R,{type:"primary",plain:"",onClick:Y},{default:s(()=>[...e[13]||(e[13]=[u(" 重新诊断 ",-1)])]),_:1})])]),A(x,{class:"mb",title:(j=(E=a.value)==null?void 0:E.meta)==null?void 0:j.disclaimer,type:"warning","show-icon":"",closable:!1},null,8,["title"]),t("div",he,[A(f,{shadow:"never",class:"report-card"},{header:s(()=>[...e[14]||(e[14]=[t("div",{class:"section-title"},"总体观察",-1)])]),default:s(()=>[A(L,{column:1,border:""},{default:s(()=>[A(_,{label:"耳廓颜色"},{default:s(()=>[u(o(a.value.overview.earColor),1)]),_:1}),A(_,{label:"整体形态"},{default:s(()=>[u(o(a.value.overview.morphology),1)]),_:1}),A(_,{label:"皮肤质地"},{default:s(()=>[u(o(a.value.overview.moisture),1)]),_:1}),A(_,{label:"左右对比"},{default:s(()=>[u(o(a.value.overview.symmetry),1)]),_:1})]),_:1})]),_:1}),A(f,{shadow:"never",class:"report-card"},{header:s(()=>[...e[15]||(e[15]=[t("div",{class:"section-title"},"重点区域",-1)])]),default:s(()=>[t("div",Ie,[(n(!0),d(k,null,b(a.value.keyAreas,i=>(n(),V(f,{key:i.area,shadow:"hover",class:"area"},{default:s(()=>[t("div",Ue,o(i.area),1),t("div",Re,[e[16]||(e[16]=t("span",{class:"k"},"发现",-1)),t("span",Ce,o(i.finding),1)]),t("div",Me,[e[17]||(e[17]=t("span",{class:"k"},"提示",-1)),t("span",Le,o(i.implication),1)])]),_:2},1024))),128))])]),_:1}),A(f,{shadow:"never",class:"report-card"},{header:s(()=>[...e[18]||(e[18]=[t("div",{class:"section-title"},"体质辨识",-1)])]),default:s(()=>[A(L,{column:1,border:""},{default:s(()=>[A(_,{label:"倾向类型"},{default:s(()=>[A(D,{type:"warning",effect:"dark"},{default:s(()=>[u(o(a.value.constitution.type),1)]),_:1})]),_:1}),A(_,{label:"依据"},{default:s(()=>[t("ul",Te,[(n(!0),d(k,null,b(a.value.constitution.evidence,(i,w)=>(n(),d("li",{key:w},o(i),1))),128))])]),_:1}),A(_,{label:"中医解读"},{default:s(()=>[u(o(a.value.constitution.tcmInterpretation),1)]),_:1})]),_:1})]),_:1}),A(f,{shadow:"never",class:"report-card"},{header:s(()=>[...e[19]||(e[19]=[t("div",{class:"section-title"},"健康建议",-1)])]),default:s(()=>[t("div",xe,[t("div",null,[e[20]||(e[20]=t("div",{class:"sub"},"生活方式",-1)),t("ul",De,[(n(!0),d(k,null,b(a.value.suggestions.lifestyle,(i,w)=>(n(),d("li",{key:w},o(i),1))),128))])]),t("div",null,[e[21]||(e[21]=t("div",{class:"sub"},"按揉建议",-1)),t("ul",Se,[(n(!0),d(k,null,b(a.value.suggestions.acupressure,(i,w)=>(n(),d("li",{key:w},o(i),1))),128))])])]),A(Q),e[22]||(e[22]=t("div",{class:"sub"},"风险提示",-1)),t("ul",$e,[(n(!0),d(k,null,b(a.value.suggestions.riskAlerts,(i,w)=>(n(),d("li",{key:w},o(i),1))),128))])]),_:1}),A(f,{shadow:"never",class:"report-card"},{header:s(()=>[...e[23]||(e[23]=[t("div",{class:"section-title"},"下一步建议",-1)])]),default:s(()=>[A(L,{column:1,border:""},{default:s(()=>[A(_,{label:"复测建议"},{default:s(()=>[u(o(a.value.nextSteps.recommendedFollowUp),1)]),_:1}),A(_,{label:"建议记录"},{default:s(()=>[(n(!0),d(k,null,b(a.value.nextSteps.dataToCollect,i=>(n(),V(D,{key:i,type:"warning",effect:"light",class:"mr"},{default:s(()=>[u(o(i),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})])]))]}),_:1})])}}},je=te(Be,[["__scopeId","data-v-4777cf57"]]);export{je as default};
